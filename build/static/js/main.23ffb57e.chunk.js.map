{"version":3,"sources":["Header/index.js","App.js","serviceWorker.js","index.js"],"names":["MyDropzone","titleName","className","getFileInfo","children","useState","file","setFile","onDrop","useCallback","acceptedFiles","useDropzone","getRootProps","getInputProps","isDragActive","multiple","name","Header","refs","tagSelector","useRef","additionSelector","editSheetA","editSheetB","editSheetC","tags","setTags","conflicts","setConflicts","additions","setAdditions","expandTable","setExpandTable","expandResult","setExpandResult","isStart","setStart","showResult","setShowResult","sheetA","setSheetA","sheetB","setSheetB","sheetC","setSheetC","getCsvContent","csvString","cellRegex","split","map","line","cellData","filter","element","undefined","useEffect","handleLoadFiles","files","sheetName","console","log","reader","FileReader","onload","data","result","sheet","readAsText","handleExchangeSheet","newSheetA","JSON","parse","stringify","newSheetAName","newSheetB","newSheetBName","handleClickSelectTag","item","newTags","slice","indexOf","push","index","findIndex","splice","handleClickSelectAddition","Additions","handleClickToggleElement","e","self","currentTarget","target","current","classList","contains","remove","add","handleClickDownloadCsv","handleTriggerDownloadCsv","csv","forEach","sheetLine","sheetCell","cellIndex","cell","replace","fileName","csvContent","encodeURI","download","downloadTrigger","document","createElement","setAttribute","click","body","append","onClick","ref","key","tag","tagIndex","addition","additionIndex","conflictLines","maximumColumn","length","minimumColumn","lineB","matchers","resultLine","resultLineIndex","array","matcher","includes","matchChecker","i","handleSubmitOptions","htmlFor","onChange","id","type","lineIndex","App","Boolean","window","location","hostname","match","ReactDOM","render","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.23ffb57e.chunk.js","sourcesContent":["import React, { useEffect, useState, useRef, useCallback } from 'react';\nimport Axios from 'axios';\nimport { List } from 'immutable';\nimport convertCSVToArray from 'convert-csv-to-array';\nimport { useDropzone } from 'react-dropzone'\nimport './style.css';\n\nfunction downloadTrigger(fileName, download) {\n  const downloadTrigger = document.createElement('a');\n  downloadTrigger.setAttribute('download', fileName);\n  downloadTrigger.setAttribute('href', download);\n  downloadTrigger.click();\n  document.body.append(downloadTrigger)\n  // downloadTrigger.remove();\n}\n\nfunction MyDropzone({titleName, className, getFileInfo, children}) {\n  const [file, setFile] = useState(null);\n\n  const onDrop = useCallback(acceptedFiles => {\n    setFile(acceptedFiles[0])\n    getFileInfo(acceptedFiles)\n  }, [])\n\n  const { getRootProps, getInputProps, isDragActive } = useDropzone({ onDrop })\n\n  return (\n    <div {...getRootProps()} className={`${className} ${isDragActive ? '-active' : ''}`}>\n      <input {...getInputProps()} multiple={false} />\n      <div className=\"icon\">\n        <i className=\"far fa-file-alt\"></i>\n      </div>\n      {\n        isDragActive ?\n        <p className=\"msg\">拖曳到這裡</p> :\n        <p className=\"msg\">點擊或拖曳到這裡</p>\n      }\n      {\n        file ?\n        <p className=\"name\"><i className=\"fas fa-check-circle\"></i> {titleName} {file.name}</p> :\n        <p className=\"info\">{children}</p>\n      }\n    </div>\n  )\n}\n\nfunction Header() {\n  // Refs\n  const refs = {\n    tagSelector: useRef(null),\n    additionSelector: useRef(null),\n    editSheetA: useRef(null),\n    editSheetB: useRef(null),\n    editSheetC: useRef(null),\n  }\n  \n  const [tags, setTags] = useState([]);\n  const [conflicts, setConflicts] = useState([]);\n  const [additions, setAdditions] = useState([]);\n  const [expandTable, setExpandTable] = useState('normal');\n  const [expandResult, setExpandResult] = useState('normal');\n  const [isStart, setStart] = useState(false);\n  const [showResult, setShowResult] = useState(false);\n  const [sheetA, setSheetA] = useState(null);\n  const [sheetB, setSheetB] = useState(null);\n  const [sheetC, setSheetC] = useState(null);\n\n  useEffect(() => {\n    // if (!sheetA || !sheetB) {\n    //   handleLoadAllData();\n    // }\n  }, [tags, additions]);\n\n  function getCsvContent(csvString) {\n    const lineRegex = /\\n(?=(?:(?:[^\"]*\"){2})*[^\"]*$)/g;\n    const cellRegex = /,(?=(?:(?:[^\"]*\"){2})*[^\"]*$)/g;\n    const lines = csvString.split(lineRegex);\n    const cells = lines.map(line => {\n      let cellData = line.split(cellRegex);\n      cellData = cellData.filter(function (element) {\n        return element !== undefined;\n      });\n      return cellData\n    });\n    return cells;\n  }\n  \n  const handleClickStart = () => {\n    setStart(true);\n  }\n  const handleLoadFiles = (files, sheetName) => {\n    const file = files[0];\n    console.log(files)\n    const reader = new FileReader();\n    reader.onload = function () {\n      const data = getCsvContent(reader.result);\n      switch (sheetName) {\n        case 'sheetA':\n          setSheetA({ name: file.name, sheet: data });\n          break;\n        case 'sheetB':\n          setSheetB({ name: file.name, sheet: data });\n          break;\n      \n        default:\n          break;\n      }\n    };\n    reader.readAsText(file);\n  }\n  const handleExchangeSheet = () => {\n    const newSheetA = JSON.parse(JSON.stringify(sheetB.sheet));\n    const newSheetAName = sheetB.name;\n    const newSheetB = JSON.parse(JSON.stringify(sheetA.sheet));\n    const newSheetBName = sheetA.name;\n\n    setSheetA({ name: newSheetAName, sheet: newSheetA });\n    setSheetB({ name: newSheetBName, sheet: newSheetB });\n  }\n  const handleLoadAllData = () => {\n    Axios.get('/config/test.csv')\n    .then(result => {\n      const Asheet = getCsvContent(result.data);\n      setSheetA({name: 'test.csv', sheet: Asheet});\n      Axios.get('/config/test2.csv')\n      .then(result => {\n        const Bsheet = getCsvContent(result.data);\n        setSheetB({name: 'test2.csv', sheet: Bsheet});\n      });\n    });\n  }\n  const handleClickSelectTag = (item) => {\n    const newTags = tags.slice();\n    if (newTags.indexOf(item) === -1) {\n      newTags.push(item);\n    }\n    else {\n      const index = newTags.findIndex(filter => filter === item);\n      newTags.splice(index, 1);\n    }\n    setTags(newTags);\n  }\n  const handleClickSelectAddition = (item) => {\n    const Additions = additions.slice();\n    if (Additions.indexOf(item) === -1) {\n      Additions.push(item);\n    }\n    else {\n      const index = Additions.findIndex(filter => filter === item);\n      Additions.splice(index, 1);\n    }\n    setAdditions(Additions);\n  }\n  const handleSubmitOptions = () => {\n    function matchChecker(array, matchers) {\n      const result = matchers.map(matcher => {\n        return array.indexOf(matcher) !== -1;\n      });\n      return result.includes(true);\n    }\n    \n    const result = JSON.parse(JSON.stringify(sheetA.sheet));\n    const conflictLines = [];\n    \n    const maximumColumn = result[0].length + additions.length;\n    const minimumColumn = result[0].length;\n\n    additions.forEach(index => {\n      result[0].push(sheetB.sheet[0][index]);\n    });\n\n    sheetB.sheet.forEach(lineB => {\n      const matchers = tags.map(tagIndex => lineB[tagIndex]);\n      result.forEach((resultLine, resultLineIndex) => {\n        if (resultLineIndex !== 0) {\n          const isMatch = matchChecker(resultLine, matchers);\n          if (isMatch) {\n            additions.forEach((additionIndex, index) => {\n              if (resultLine.length < maximumColumn) {\n                resultLine.push(lineB[additionIndex]);\n              }\n              else {\n                conflictLines.indexOf(resultLineIndex) === -1 && conflictLines.push(resultLineIndex);\n                resultLine[minimumColumn + index] += ` ／ ${lineB[additionIndex]}`;\n              }\n            });\n          }\n        }\n      })\n    });\n\n    result.forEach(resultLine => {\n      if (resultLine.length < maximumColumn) {\n        for (let i = 0; i < maximumColumn; i++) {\n          resultLine[i] = resultLine[i] === undefined ? '' : resultLine[i];\n        }\n      }\n    })\n\n    setSheetC(result);\n    setConflicts(conflictLines);\n    setShowResult(true);\n  }\n  const handleClickToggleElement = (e, element) => {\n    const self = e.currentTarget;\n    const target = refs[element].current;\n    target.classList.contains('-active') ? target.classList.remove('-active') : target.classList.add('-active');\n    self.classList.contains('-active') ? self.classList.remove('-active') : self.classList.add('-active');\n  }\n  const handleClickClearResult = () => {\n    setSheetC([]);\n    setShowResult(false);\n  }\n  \n  const handleClickDownloadCsv = (sheetName) => {\n    switch (sheetName) {\n      case 'sheetA': handleTriggerDownloadCsv(sheetA.name, sheetA.sheet);\n        break;\n\n      case 'sheetB': handleTriggerDownloadCsv(sheetB.name, sheetB.sheet);\n        break;\n        \n      case 'sheetC': handleTriggerDownloadCsv(`merge-${sheetA.name}`, sheetC);\n        break;\n    \n      default:\n        break;\n    }\n  }\n\n  const handleTriggerDownloadCsv = (name, sheet) => {\n    let csv = '';\n    sheet.forEach(sheetLine => {\n      let line = '';\n      sheetLine.forEach((sheetCell, cellIndex) => {\n        if (cellIndex === 0) {\n          console.log(sheetCell)\n        }\n        let cell = sheetCell.replace(/#/gi, '＃');\n        // cell = cell.indexOf(',') === -1 ? cell : `\"${cell}\"`\n        cell = cellIndex === 0 ? cell : `,${cell}`;\n        line += cell;\n      })\n      csv += line + '\\n'\n    });\n\n    // sheet.forEach(line => {\n    //   console.log(line.join(','))\n    // })\n    console.log(csv)\n\n    const fileName = `${name}`;\n    const csvContent = \"data:text/csv;charset=utf-8,%EF%BB%BF\" + encodeURI(csv);\n\n    console.log(csvContent)\n\n    downloadTrigger(fileName, csvContent);\n  }\n\n  return (\n    <div className=\"csv-matcher\">\n      <div className={`upload-wrapper ${isStart ? '-active' : ''}`}>\n        <div className={`drop-zone ${(sheetA && sheetB) ? '-active' : ''}`}>\n          <MyDropzone titleName=\"基礎表格\" className=\"file\" getFileInfo={file => handleLoadFiles(file, 'sheetA')}>【基礎表格】用來被比對表格內的資料，也可以幫表格內擴充更多內容。</MyDropzone>\n          <MyDropzone titleName=\"對照表格\" className=\"file\" getFileInfo={file => handleLoadFiles(file, 'sheetB')}>【對照表格】用來比對基礎表格內的資料，也可以用對照表格的欄位擴充到基礎表格。</MyDropzone>\n          <button className={`start ${(sheetA && sheetB) ? '-active' : ''}`}\n          onClick={handleClickStart}><i className=\"fas fa-table\"></i> 開始製作表格</button>\n        </div>\n      </div>\n      <div className={`application ${showResult ? '-result' : ''} -${expandResult}`} >\n        <div className=\"options-bar\">\n          <div className=\"controller-wrapper\">\n            <div className=\"tag-selector controller\">\n              <div className=\"dropdown\">\n                <div className=\"head\" onClick={ (e) => handleClickToggleElement(e, 'tagSelector') }>\n                  <i className=\"fas fa-thumbtack\"></i>\n                  <span>核對欄位</span>\n                </div>\n                <div className=\"items\" ref={refs.tagSelector}>\n                  { sheetB &&\n                    sheetB.sheet[0].map((cell, cellIndex) =>\n                      <button key={cellIndex} className={ tags.indexOf(cellIndex) !== -1 ? '-tag' : ''}\n                      onClick={() => handleClickSelectTag(cellIndex)}>{cell}</button> )}\n                </div>\n              </div>\n              <div className=\"selected\">\n                { tags &&\n                  tags.map((tag, tagIndex) =>\n                  <button key={tagIndex}\n                      onClick={() => handleClickSelectTag(tag)}><i className=\"fa fa-times\"></i>{sheetB.sheet[0][tag]}</button>) }\n              </div>\n            </div>\n            <div className=\"addition-selector controller\">\n              <div className=\"dropdown\">\n                <div className=\"head\" onClick={ (e) => handleClickToggleElement(e, 'additionSelector') }>\n                  <i className=\"fas fa-file-import\"></i>\n                  <span>添加欄位</span>\n                </div>\n                <div className=\"items\" ref={refs.additionSelector}>\n                  { sheetB &&\n                    sheetB.sheet[0].map((cell, cellIndex) =>\n                      <button key={cellIndex} className={ additions.indexOf(cellIndex) !== -1 ? '-tag' : ''}\n                      onClick={() => handleClickSelectAddition(cellIndex)}>{cell}</button> )}\n                </div>\n              </div>\n              <div className=\"selected\">\n                { additions &&\n                  additions.map((addition, additionIndex) =>\n                  <button key={additionIndex}\n                      onClick={() => handleClickSelectAddition(addition)}><i className=\"fa fa-times\"></i>{sheetB.sheet[0][addition]}</button>) }\n              </div>\n            </div>\n          </div>\n          <button className=\"options-submit\"\n          onClick={() => handleSubmitOptions()}>\n            <i className=\"fas fa-edit\"></i>\n            <span>製作表格</span>\n          </button>\n        </div>\n        <div className={`table-wrapper -${expandTable} `}>\n          <div className=\"item left\">\n            <div className=\"table-head\">\n              <div className=\"name\">\n                <i className=\"icon fas fa-table\"></i>\n                <span>基礎表格 { sheetA && sheetA.name }</span>\n              </div>\n              <div className=\"dropdown\">\n                <button onClick={(e) => handleClickToggleElement(e, 'editSheetA')}>編輯</button>\n                <div className=\"items\" ref={refs.editSheetA}>\n                  <button className=\"file-selector\">\n                    <label htmlFor=\"sheet-a-upload\">重新選擇表格</label>\n                    <input onChange={(e) => {\n                      handleLoadFiles(e.target.files, 'sheetA')\n                      handleClickToggleElement(e, 'editSheetA')\n                    }} id=\"sheet-a-upload\" className=\"button\" type=\"file\" />\n                  </button>\n                  <button onClick={handleExchangeSheet}>表格互換</button>\n                  <button onClick={(e) => {\n                    handleClickDownloadCsv('sheetA')\n                    handleClickToggleElement(e, 'editSheetA')\n                  }}>下載此表格</button>\n                </div>\n              </div>\n            </div>\n            <div className=\"table\">\n              <table>\n                <tbody>\n                  {\n                    sheetA && sheetA.sheet.map((line, lineIndex) => \n                      <tr key={`l${lineIndex}`}>\n                        { line.map((cell, cellIndex) => <td key={`c${cellIndex}`}>{ cell }</td>) }\n                      </tr>\n                    )\n                  }\n                </tbody>\n              </table>\n            </div>\n            { expandTable === 'normal' && <button className=\"expand-button\" onClick={() => setExpandTable('left')}><i className=\"fa fa-expand-alt\"></i></button> }\n            { expandTable !== 'normal' && <button className=\"expand-button -reverse\" onClick={() => setExpandTable('normal')}><i className=\"fa fa-compress-alt\"></i></button> }\n          </div>\n          <div className=\"item right\">\n            <div className=\"table-head\">\n              <div className=\"name\">\n                <i className=\"icon fas fa-angle-double-left\"></i>\n                <span>對照表格 { sheetB && sheetB.name }</span>\n              </div>\n              <div className=\"dropdown\">\n                <button onClick={(e) => handleClickToggleElement(e, 'editSheetB')}>編輯</button>\n                <div className=\"items\" ref={refs.editSheetB}>\n                  <button className=\"file-selector\">\n                    <label htmlFor=\"sheet-b-upload\">重新選擇表格</label>\n                    <input onChange={(e) => {\n                      handleLoadFiles(e.target.files, 'sheetB')\n                      handleClickToggleElement(e, 'editSheetB')\n                    }} id=\"sheet-b-upload\" className=\"button\" type=\"file\" />\n                  </button>\n                  <button onClick={handleExchangeSheet}>表格互換</button>\n                  <button onClick={(e) => {\n                    handleClickDownloadCsv('sheetB')\n                    handleClickToggleElement(e, 'editSheetB')\n                  }}>下載此表格</button>\n                </div>\n              </div>\n            </div>\n            <div className=\"table\">\n              <table>\n                <tbody>\n                  {\n                    sheetB && sheetB.sheet.map((line, lineIndex) => \n                      <tr key={`l${lineIndex}`}>\n                        {\n                          line.map((cell, cellIndex) => {\n                            return (\n                              <td key={`c${cellIndex}`}\n                              className={`${tags.indexOf(cellIndex) !== -1 ? '-tag' : ''} ${additions.indexOf(cellIndex) !== -1 ? '-addition' : ''}`}\n                              >{ cell }</td>\n                            )\n                          })\n                        }\n                      </tr>\n                    )\n                  }\n                </tbody>\n              </table>\n            </div>\n            {expandTable === 'normal' && <button className=\"expand-button\" onClick={() => setExpandTable('right')}><i className=\"fa fa-expand-alt\"></i></button>}\n            {expandTable !== 'normal' && <button className=\"expand-button -reverse\" onClick={() => setExpandTable('normal')}><i className=\"fa fa-compress-alt\"></i></button>}\n          </div>\n        </div>\n        <div className=\"result-wrapper\">\n          <div className=\"table-head\">\n            <div className=\"name\">\n              <i className=\"icon fas fa-columns\"></i>\n              <span>合併後表格</span>\n            </div>\n            <div className=\"dropdown\">\n              <button onClick={(e) => handleClickToggleElement(e, 'editSheetC')}>編輯</button>\n              <div className=\"items\" ref={refs.editSheetC}>\n                <button onClick={(e) => {\n                  handleClickDownloadCsv('sheetC')\n                  handleClickToggleElement(e, 'editSheetC')\n                }}>下載此表格</button>\n              </div>\n            </div>\n            <button className=\"close\" onClick={handleClickClearResult} ><i className=\"fas fa-times\"></i></button>\n          </div>\n          <div className=\"table\">\n            <table>\n              <tbody>\n                {\n                  sheetC && sheetC.map((line, lineIndex) =>\n                    <tr key={`l${lineIndex}`}\n                      className={conflicts.indexOf(lineIndex) !== -1 ? '-conflict' : ''}> \n                      {line.map((cell, cellIndex) => \n                        <td key={`c${cellIndex}`} className={cellIndex+1 > sheetA.sheet[0].length ? '-increase' : ''}>{cell}</td>\n                      )}\n                    </tr>\n                  )\n                }\n              </tbody>\n            </table>\n          </div>\n          {expandResult === 'fill' && <button className=\"expand-button\" onClick={() => setExpandResult('normal')}><i className=\"fa fa-compress-alt\"></i></button>}\n          {expandResult !== 'fill' && <button className=\"expand-button -reverse\" onClick={() => setExpandResult('fill')}><i className=\"fa fa-expand-alt\"></i></button>}\n        </div>\n        {/* <input type=\"file\" id=\"input\" onChange={handleFiles}></input> */}\n      </div>\n    </div>\n  );\n}\n\nexport default Header;\n","import React from 'react';\nimport './App.css';\nimport Header from './Header';\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <Header></Header>\n    </div>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}